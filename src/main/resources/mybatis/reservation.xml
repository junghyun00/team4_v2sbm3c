<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="dev.mvc.reservation.ReservationDAOInter">

    <!-- 주차장 등록 -->
    <insert id="reservation_create" parameterType="dev.mvc.reservation.ReservationVO">
        INSERT INTO reservation(reserveno, memberno, parkno, reservedate,reservetime, carno,notice)
        VALUES (reservation_seq.nextval, #{memberno}, #{parkno}, TO_DATE(#{reservedate},'YYYY-MM-DD'), TO_DATE(#{reservetime},'HH24:MI'), #{ carno}, #{notice})
    </insert>
    
     <!-- 글 한 개 조회  -->
    <select id="read" resultType="dev.mvc.reservation.ReservationVO" parameterType="int">
        SELECT reserveno, memberno, parkno, reservedate, reservetime, carno,notice
        FROM reservation
        WHERE reserveno = #{reserveno}
    </select>
    
    
    
    <!-- 회원별 예약 목록  -->
    <select id="my_reser" resultType="dev.mvc.reservation.ReservationVO" parameterType="int">
        SELECT reserveno, memberno, parkno, reservedate, reservetime, carno,notice
        FROM reservation
        WHERE memberno = #{memberno}
        ORDER BY memberno DESC
    </select>
    
    
    <!-- 회원별 예약 목록 Park + Reservation join  -->
    <select id="my_reser_join" resultType="dev.mvc.reservation.Park_ReservationVO" parameterType="int">
        SELECT p.parkno as p_parkno, p.name as p_name, 
                   r.reservedate, r.carno, r.notice
        FROM park p, reservation r
        WHERE p.parkno = r.parkno AND r.memberno= #{memberno}
        ORDER BY r.reserveno DESC
    </select>
    
    
    </mapper>
